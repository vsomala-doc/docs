"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[1952],{31952:(e,t,n)=>{n.r(t),n.d(t,{debouncedSearch:()=>Y,destroy:()=>J,filters:()=>V,init:()=>B,mergeIndex:()=>G,options:()=>O,preload:()=>H,search:()=>z});let r;!function(){const e={};let t,n;"undefined"!=typeof document&&null!==document.currentScript&&(t=new URL("UNHANDLED",location.href).toString());let a=null;function i(){return null!==a&&0!==a.byteLength||(a=new Uint8Array(n.memory.buffer)),a}let s=0;function o(e,t){const n=t(1*e.length,1)>>>0;return i().set(e,n/1),s=e.length,n}e.init_pagefind=function(e){const t=o(e,n.__wbindgen_malloc),r=s;return n.init_pagefind(t,r)>>>0};const l="undefined"!=typeof TextEncoder?new TextEncoder("utf-8"):{encode:()=>{throw Error("TextEncoder not available")}},c="function"==typeof l.encodeInto?function(e,t){return l.encodeInto(e,t)}:function(e,t){const n=l.encode(e);return t.set(n),{read:e.length,written:n.length}};function h(e,t,n){if(void 0===n){const n=l.encode(e),r=t(n.length,1)>>>0;return i().subarray(r,r+n.length).set(n),s=n.length,r}let r=e.length,a=t(r,1)>>>0;const o=i();let h=0;for(;h<r;h++){const t=e.charCodeAt(h);if(t>127)break;o[a+h]=t}if(h!==r){0!==h&&(e=e.slice(h)),a=n(a,r,r=h+3*e.length,1)>>>0;const t=i().subarray(a+h,a+r);h+=c(e,t).written,a=n(a,r,h,1)>>>0}return s=h,a}e.set_ranking_weights=function(e,t){const r=h(t,n.__wbindgen_malloc,n.__wbindgen_realloc),a=s;return n.set_ranking_weights(e,r,a)>>>0},e.load_index_chunk=function(e,t){const r=o(t,n.__wbindgen_malloc),a=s;return n.load_index_chunk(e,r,a)>>>0},e.load_filter_chunk=function(e,t){const r=o(t,n.__wbindgen_malloc),a=s;return n.load_filter_chunk(e,r,a)>>>0},e.add_synthetic_filter=function(e,t){const r=h(t,n.__wbindgen_malloc,n.__wbindgen_realloc),a=s;return n.add_synthetic_filter(e,r,a)>>>0};let d=null;function f(){return null!==d&&0!==d.byteLength||(d=new Int32Array(n.memory.buffer)),d}const u="undefined"!=typeof TextDecoder?new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0}):{decode:()=>{throw Error("TextDecoder not available")}};function g(e,t){return e>>>=0,u.decode(i().subarray(e,e+t))}function _(){const e={wbg:{}};return e}function w(e,t){return n=e.exports,p.__wbindgen_wasm_module=t,d=null,a=null,n}async function p(e){if(void 0!==n)return n;void 0===e&&void 0!==t&&(e=t.replace(/\.js$/,"_bg.wasm"));const r=_();("string"==typeof e||"function"==typeof Request&&e instanceof Request||"function"==typeof URL&&e instanceof URL)&&(e=fetch(e));const{instance:a,module:i}=await async function(e,t){if("function"==typeof Response&&e instanceof Response){if("function"==typeof WebAssembly.instantiateStreaming)try{return await WebAssembly.instantiateStreaming(e,t)}catch(n){if("application/wasm"==e.headers.get("Content-Type"))throw n;console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",n)}const r=await e.arrayBuffer();return await WebAssembly.instantiate(r,t)}{const n=await WebAssembly.instantiate(e,t);return n instanceof WebAssembly.Instance?{instance:n,module:e}:n}}(await e,r);return w(a,i)}"undefined"!=typeof TextDecoder&&u.decode(),e.request_indexes=function(e,t){let r,a;try{const l=n.__wbindgen_add_to_stack_pointer(-16),c=h(t,n.__wbindgen_malloc,n.__wbindgen_realloc),d=s;n.request_indexes(l,e,c,d);var i=f()[l/4+0],o=f()[l/4+1];return r=i,a=o,g(i,o)}finally{n.__wbindgen_add_to_stack_pointer(16),n.__wbindgen_free(r,a,1)}},e.request_filter_indexes=function(e,t){let r,a;try{const l=n.__wbindgen_add_to_stack_pointer(-16),c=h(t,n.__wbindgen_malloc,n.__wbindgen_realloc),d=s;n.request_filter_indexes(l,e,c,d);var i=f()[l/4+0],o=f()[l/4+1];return r=i,a=o,g(i,o)}finally{n.__wbindgen_add_to_stack_pointer(16),n.__wbindgen_free(r,a,1)}},e.request_all_filter_indexes=function(e){let t,r;try{const s=n.__wbindgen_add_to_stack_pointer(-16);n.request_all_filter_indexes(s,e);var a=f()[s/4+0],i=f()[s/4+1];return t=a,r=i,g(a,i)}finally{n.__wbindgen_add_to_stack_pointer(16),n.__wbindgen_free(t,r,1)}},e.filters=function(e){let t,r;try{const s=n.__wbindgen_add_to_stack_pointer(-16);n.filters(s,e);var a=f()[s/4+0],i=f()[s/4+1];return t=a,r=i,g(a,i)}finally{n.__wbindgen_add_to_stack_pointer(16),n.__wbindgen_free(t,r,1)}},e.search=function(e,t,r,a,i){let o,l;try{const u=n.__wbindgen_add_to_stack_pointer(-16),_=h(t,n.__wbindgen_malloc,n.__wbindgen_realloc),w=s,p=h(r,n.__wbindgen_malloc,n.__wbindgen_realloc),m=s,y=h(a,n.__wbindgen_malloc,n.__wbindgen_realloc),b=s;n.search(u,e,_,w,p,m,y,b,i);var c=f()[u/4+0],d=f()[u/4+1];return o=c,l=d,g(c,d)}finally{n.__wbindgen_add_to_stack_pointer(16),n.__wbindgen_free(o,l,1)}},r=Object.assign(p,{initSync:function(e){if(void 0!==n)return n;const t=_();return e instanceof WebAssembly.Module||(e=new WebAssembly.Module(e)),w(new WebAssembly.Instance(e,t),e)}},e)}();var a=Uint8Array,i=Uint16Array,s=Uint32Array,o=new a([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),l=new a([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),c=new a([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),h=function(e,t){for(var n=new i(31),r=0;r<31;++r)n[r]=t+=1<<e[r-1];var a=new s(n[30]);for(r=1;r<30;++r)for(var o=n[r];o<n[r+1];++o)a[o]=o-n[r]<<5|r;return[n,a]},d=h(o,2),f=d[0],u=d[1];f[28]=258,u[258]=28;var g,_=h(l,0),w=_[0],p=(_[1],new i(32768));for(b=0;b<32768;++b)g=(61680&(g=(52428&(g=(43690&b)>>>1|(21845&b)<<1))>>>2|(13107&g)<<2))>>>4|(3855&g)<<4,p[b]=((65280&g)>>>8|(255&g)<<8)>>>1;var m=function(e,t,n){for(var r=e.length,a=0,s=new i(t);a<r;++a)e[a]&&++s[e[a]-1];var o,l=new i(t);for(a=0;a<t;++a)l[a]=l[a-1]+s[a-1]<<1;if(n){o=new i(1<<t);var c=15-t;for(a=0;a<r;++a)if(e[a])for(var h=a<<4|e[a],d=t-e[a],f=l[e[a]-1]++<<d,u=f|(1<<d)-1;f<=u;++f)o[p[f]>>>c]=h}else for(o=new i(r),a=0;a<r;++a)e[a]&&(o[a]=p[l[e[a]-1]++]>>>15-e[a]);return o},y=new a(288);for(b=0;b<144;++b)y[b]=8;for(b=144;b<256;++b)y[b]=9;for(b=256;b<280;++b)y[b]=7;for(b=280;b<288;++b)y[b]=8;var b,k=new a(32);for(b=0;b<32;++b)k[b]=5;var v=m(y,9,1),P=m(k,5,1),x=function(e){for(var t=e[0],n=1;n<e.length;++n)e[n]>t&&(t=e[n]);return t},$=function(e,t,n){var r=t/8|0;return(e[r]|e[r+1]<<8)>>(7&t)&n},F=function(e,t){var n=t/8|0;return(e[n]|e[n+1]<<8|e[n+2]<<16)>>(7&t)},S=function(e){return(e+7)/8|0},E=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],U=function(e,t,n){var r=new Error(t||E[e]);if(r.code=e,Error.captureStackTrace&&Error.captureStackTrace(r,U),!n)throw r;return r},L=function(e,t,n){var r=e.length;if(!r||n&&n.f&&!n.l)return t||new a(0);var h=!t||n,d=!n||n.i;n||(n={}),t||(t=new a(3*r));var u=function(e){var n=t.length;if(e>n){var r=new a(Math.max(2*n,e));r.set(t),t=r}},g=n.f||0,_=n.p||0,p=n.b||0,y=n.l,b=n.d,k=n.m,E=n.n,L=8*r;do{if(!y){g=$(e,_,1);var A=$(e,_+1,3);if(_+=3,!A){var D=e[(B=S(_)+4)-4]|e[B-3]<<8,I=B+D;if(I>r){d&&U(0);break}h&&u(p+D),t.set(e.subarray(B,I),p),n.b=p+=D,n.p=_=8*I,n.f=g;continue}if(1==A)y=v,b=P,k=9,E=5;else if(2==A){var M=$(e,_,31)+257,W=$(e,_+10,15)+4,T=M+$(e,_+5,31)+1;_+=14;for(var R=new a(T),C=new a(19),j=0;j<W;++j)C[c[j]]=$(e,_+3*j,7);_+=3*W;var q=x(C),N=(1<<q)-1,O=m(C,q,1);for(j=0;j<T;){var B,J=O[$(e,_,N)];if(_+=15&J,(B=J>>>4)<16)R[j++]=B;else{var G=0,z=0;for(16==B?(z=3+$(e,_,3),_+=2,G=R[j-1]):17==B?(z=3+$(e,_,7),_+=3):18==B&&(z=11+$(e,_,127),_+=7);z--;)R[j++]=G}}var Y=R.subarray(0,M),H=R.subarray(M);k=x(Y),E=x(H),y=m(Y,k,1),b=m(H,E,1)}else U(1);if(_>L){d&&U(0);break}}h&&u(p+131072);for(var V=(1<<k)-1,K=(1<<E)-1,Q=_;;Q=_){var X=(G=y[F(e,_)&V])>>>4;if((_+=15&G)>L){d&&U(0);break}if(G||U(2),X<256)t[p++]=X;else{if(256==X){Q=_,y=null;break}var Z=X-254;if(X>264){var ee=o[j=X-257];Z=$(e,_,(1<<ee)-1)+f[j],_+=ee}var te=b[F(e,_)&K],ne=te>>>4;te||U(3),_+=15&te;H=w[ne];if(ne>3){ee=l[ne];H+=F(e,_)&(1<<ee)-1,_+=ee}if(_>L){d&&U(0);break}h&&u(p+131072);for(var re=p+Z;p<re;p+=4)t[p]=t[p-H],t[p+1]=t[p+1-H],t[p+2]=t[p+2-H],t[p+3]=t[p+3-H];p=re}}n.l=y,n.p=Q,n.b=p,n.f=g,y&&(g=1,n.m=k,n.d=b,n.n=E)}while(!g);return p==t.length?t:function(e,t,n){(null==t||t<0)&&(t=0),(null==n||n>e.length)&&(n=e.length);var r=new(2==e.BYTES_PER_ELEMENT?i:4==e.BYTES_PER_ELEMENT?s:a)(n-t);return r.set(e.subarray(t,n)),r}(t,0,p)},A=new a(0);var D="undefined"!=typeof TextDecoder&&new TextDecoder;try{D.decode(A,{stream:!0})}catch(K){}var I=function(e,t){return L(e.subarray(function(e){31==e[0]&&139==e[1]&&8==e[2]||U(6,"invalid gzip data");var t=e[3],n=10;4&t&&(n+=e[10]|2+(e[11]<<8));for(var r=(t>>3&1)+(t>>4&1);r>0;r-=!e[n++]);return n+(2&t)}(e),-8),t||new a((r=(n=e).length,(n[r-4]|n[r-3]<<8|n[r-2]<<16|n[r-1]<<24)>>>0)));var n,r},M=(e,t)=>{if(0===e.length)return 0;let n=[];for(const s of e)n[s.location]=n[s.location]||0,n[s.location]+=s.balanced_score;if(n.length<=t)return 0;let r=n.slice(0,t).reduce((e,t)=>e+t,0),a=r,i=[0];for(let s=0;s<n.length;s++){a+=(n[s+t]??0)-(n[s]??0),a>r?(r=a,i=[s]):a===r&&i[i.length-1]===s-1&&i.push(s)}return i[Math.floor(i.length/2)]},W=(e,t,n,r,a,i)=>{let s=e.includes("\u200b"),o=[];o=s?e.split("\u200b"):e.split(/[\r\n\s]+/g);for(let h of r)o[h]?.startsWith("<mark>")||(o[h]=`<mark>${o[h]}</mark>`);let l=i??o.length,c=a??0;return l-c<n&&(n=l-c),t+n>l&&(t=l-n),t<c&&(t=c),o.slice(t,t+n).join(s?"":" ").trim()},T=async(e=100)=>new Promise(t=>setTimeout(t,e)),R=class{constructor(e={}){this.version="1.3.0",this.backend=r,this.decoder=new TextDecoder("utf-8"),this.wasm=null,this.basePath=e.basePath||"/pagefind/",this.primary=e.primary||!1,this.primary&&!e.basePath&&this.initPrimary(),/[^\/]$/.test(this.basePath)&&(this.basePath=`${this.basePath}/`),window?.location?.origin&&this.basePath.startsWith(window.location.origin)&&(this.basePath=this.basePath.replace(window.location.origin,"")),this.baseUrl=e.baseUrl||this.defaultBaseUrl(),/^(\/|https?:\/\/)/.test(this.baseUrl)||(this.baseUrl=`/${this.baseUrl}`),this.indexWeight=e.indexWeight??1,this.excerptLength=e.excerptLength??30,this.mergeFilter=e.mergeFilter??{},this.ranking=e.ranking,this.highlightParam=e.highlightParam??null,this.loaded_chunks={},this.loaded_filters={},this.loaded_fragments={},this.raw_ptr=null,this.searchMeta=null,this.languages=null}initPrimary(){let e="file:///C:/docs/my-website/static/pagefind/pagefind.js".match(/^(.*\/)pagefind.js.*$/)?.[1];e?this.basePath=e:console.warn(["Pagefind couldn't determine the base of the bundle from the import path. Falling back to the default.","Set a basePath option when initialising Pagefind to ignore this message."].join("\n"))}defaultBaseUrl(){let e=this.basePath.match(/^(.*\/)_?pagefind/)?.[1];return e||"/"}async options(e){const t=["basePath","baseUrl","indexWeight","excerptLength","mergeFilter","highlightParam","ranking"];for(const[n,r]of Object.entries(e))if("mergeFilter"===n){let e=this.stringifyFilters(r),t=await this.getPtr();this.raw_ptr=this.backend.add_synthetic_filter(t,e)}else"ranking"===n?await this.set_ranking(e.ranking):t.includes(n)?("basePath"===n&&"string"==typeof r&&(this.basePath=r),"baseUrl"===n&&"string"==typeof r&&(this.baseUrl=r),"indexWeight"===n&&"number"==typeof r&&(this.indexWeight=r),"excerptLength"===n&&"number"==typeof r&&(this.excerptLength=r),"mergeFilter"===n&&"object"==typeof r&&(this.mergeFilter=r),"highlightParam"===n&&"string"==typeof r&&(this.highlightParam=r)):console.warn(`Unknown Pagefind option ${n}. Allowed options: [${t.join(", ")}]`)}decompress(e,t="unknown file"){return"pagefind_dcd"===this.decoder.decode(e.slice(0,12))?e.slice(12):(e=I(e),"pagefind_dcd"!==this.decoder.decode(e.slice(0,12))?(console.error(`Decompressing ${t} appears to have failed: Missing signature`),e):e.slice(12))}async set_ranking(e){if(!e)return;let t={term_similarity:e.termSimilarity??null,page_length:e.pageLength??null,term_saturation:e.termSaturation??null,term_frequency:e.termFrequency??null},n=await this.getPtr();this.raw_ptr=this.backend.set_ranking_weights(n,JSON.stringify(t))}async init(e,t){await this.loadEntry();let n=this.findIndex(e),r=n.wasm?n.wasm:"unknown",a=[this.loadMeta(n.hash)];if(!0===t.load_wasm&&a.push(this.loadWasm(r)),await Promise.all(a),this.raw_ptr=this.backend.init_pagefind(new Uint8Array(this.searchMeta)),Object.keys(this.mergeFilter)?.length){let e=this.stringifyFilters(this.mergeFilter),t=await this.getPtr();this.raw_ptr=this.backend.add_synthetic_filter(t,e)}this.ranking&&await this.set_ranking(this.ranking)}async loadEntry(){try{let e=await fetch(`${this.basePath}pagefind-entry.json?ts=${Date.now()}`),t=await e.json();this.languages=t.languages,t.version!==this.version&&(this.primary?console.warn(["Pagefind JS version doesn't match the version in your search index.",`Pagefind JS: ${this.version}. Pagefind index: ${t.version}`,"If you upgraded Pagefind recently, you likely have a cached pagefind.js file.","If you encounter any search errors, try clearing your cache."].join("\n")):console.warn(["Merging a Pagefind index from a different version than the main Pagefind instance.",`Main Pagefind JS: ${this.version}. Merged index (${this.basePath}): ${t.version}`,"If you encounter any search errors, make sure that both sites are running the same version of Pagefind."].join("\n")))}catch(K){throw console.error(`Failed to load Pagefind metadata:\n${K?.toString()}`),new Error("Failed to load Pagefind metadata")}}findIndex(e){if(this.languages){let t=this.languages[e];if(t)return t;if(t=this.languages[e.split("-")[0]],t)return t;let n=Object.values(this.languages).sort((e,t)=>t.page_count-e.page_count);if(n[0])return n[0]}throw new Error("Pagefind Error: No language indexes found.")}async loadMeta(e){try{let t=await fetch(`${this.basePath}pagefind.${e}.pf_meta`),n=await t.arrayBuffer();this.searchMeta=this.decompress(new Uint8Array(n),"Pagefind metadata")}catch(K){console.error(`Failed to load the meta index:\n${K?.toString()}`)}}async loadWasm(e){try{const t=`${this.basePath}wasm.${e}.pagefind`;let n=await fetch(t),r=await n.arrayBuffer();const a=this.decompress(new Uint8Array(r),"Pagefind WebAssembly");if(!a)throw new Error("No WASM after decompression");this.wasm=await this.backend(a)}catch(K){throw console.error(`Failed to load the Pagefind WASM:\n${K?.toString()}`),new Error(`Failed to load the Pagefind WASM:\n${K?.toString()}`)}}async _loadGenericChunk(e,t){try{let n=await fetch(e),r=await n.arrayBuffer(),a=this.decompress(new Uint8Array(r),e),i=await this.getPtr();this.raw_ptr=this.backend[t](i,a)}catch(K){console.error(`Failed to load the index chunk ${e}:\n${K?.toString()}`)}}async loadChunk(e){if(!this.loaded_chunks[e]){const t=`${this.basePath}index/${e}.pf_index`;this.loaded_chunks[e]=this._loadGenericChunk(t,"load_index_chunk")}return await this.loaded_chunks[e]}async loadFilterChunk(e){if(!this.loaded_filters[e]){const t=`${this.basePath}filter/${e}.pf_filter`;this.loaded_filters[e]=this._loadGenericChunk(t,"load_filter_chunk")}return await this.loaded_filters[e]}async _loadFragment(e){let t=await fetch(`${this.basePath}fragment/${e}.pf_fragment`),n=await t.arrayBuffer(),r=this.decompress(new Uint8Array(n),`Fragment ${e}`);return JSON.parse((new TextDecoder).decode(r))}async loadFragment(e,t=[],n){this.loaded_fragments[e]||(this.loaded_fragments[e]=this._loadFragment(e));let r=await this.loaded_fragments[e];r.weighted_locations=t,r.locations=t.map(e=>e.location),r.raw_content||(r.raw_content=r.content.replace(/</g,"&lt;").replace(/>/g,"&gt;"),r.content=r.content.replace(/\u200B/g,"")),r.raw_url||(r.raw_url=r.url),r.url=this.processedUrl(r.raw_url,n);const a=M(t,this.excerptLength);return r.excerpt=W(r.raw_content,a,this.excerptLength,r.locations),r.sub_results=((e,t)=>{const n=e.anchors.filter(e=>/h\d/i.test(e.element)&&e.text?.length&&/\S/.test(e.text)).sort((e,t)=>e.location-t.location),r=[];let a=0,i={title:e.meta.title,url:e.url,weighted_locations:[],locations:[],excerpt:""};const s=n=>{if(i.locations.length){const s=i.weighted_locations.map(e=>({weight:e.weight,balanced_score:e.balanced_score,location:e.location-a})),o=M(s,t)+a,l=n?Math.min(n-o,t):t;i.excerpt=W(e.raw_content??"",o,l,i.locations,a,n),r.push(i)}};for(let o of e.weighted_locations)if(!n.length||o.location<n[0].location)i.weighted_locations.push(o),i.locations.push(o.location);else{let t=n.shift();for(s(t.location);n.length&&o.location>=n[0].location;)t=n.shift();let r=e.url;try{if(/^((https?:)?\/\/)/.test(r)){let e=new URL(r);e.hash=t.id,r=e.toString()}else{/^\//.test(r)||(r=`/${r}`);let e=new URL(`https://example.com${r}`);e.hash=t.id,r=e.toString().replace(/^https:\/\/example.com/,"")}}catch(K){console.error(`Pagefind: Couldn't process ${r} for a search result`)}a=t.location,i={title:t.text,url:r,anchor:t,weighted_locations:[o],locations:[o.location],excerpt:""}}return s(n[0]?.location),r})(r,this.excerptLength),r}fullUrl(e){return/^(https?:)?\/\//.test(e)?e:`${this.baseUrl}/${e}`.replace(/\/+/g,"/").replace(/^(https?:\/)/,"$1/")}processedUrl(e,t){const n=this.fullUrl(e);if(null===this.highlightParam)return n;let r=t.split(/\s+/);try{let e=new URL(n);for(const t of r)e.searchParams.append(this.highlightParam,t);return e.toString()}catch(K){try{let e=new URL(`https://example.com${n}`);for(const t of r)e.searchParams.append(this.highlightParam,t);return e.toString().replace(/^https:\/\/example\.com/,"")}catch(a){return n}}}async getPtr(){for(;null===this.raw_ptr;)await T(50);if(!this.raw_ptr)throw console.error("Pagefind: WASM Error (No pointer)"),new Error("Pagefind: WASM Error (No pointer)");return this.raw_ptr}parseFilters(e){let t={};if(!e)return t;for(const n of e.split("__PF_FILTER_DELIM__")){let[e,r]=n.split(/:(.*)$/);if(t[e]={},r)for(const n of r.split("__PF_VALUE_DELIM__"))if(n){let r=n.match(/^(.*):(\d+)$/);if(r){let[,n,a]=r;t[e][n]=parseInt(a)??a}}}return t}stringifyFilters(e={}){return JSON.stringify(e)}stringifySorts(e={}){let t=Object.entries(e);for(let[n,r]of t)return t.length>1&&console.warn(`Pagefind was provided multiple sort options in this search, but can only operate on one. Using the ${n} sort.`),"asc"!==r&&"desc"!==r&&console.warn(`Pagefind was provided a sort with unknown direction ${r}. Supported: [asc, desc]`),`${n}:${r}`;return""}async filters(){let e=await this.getPtr(),t=this.backend.request_all_filter_indexes(e).split(" ").filter(e=>e).map(e=>this.loadFilterChunk(e));await Promise.all([...t]),e=await this.getPtr();let n=this.backend.filters(e);return this.parseFilters(n)}async preload(e,t={}){await this.search(e,{...t,preload:!0})}async search(e,t={}){t={verbose:!1,filters:{},sort:{},...t};const n=e=>{t.verbose&&console.log(e)};n(`Starting search on ${this.basePath}`);let r=Date.now(),a=await this.getPtr(),i=null===e,s=/^\s*".+"\s*$/.test(e=e??"");if(s&&n("Running an exact search"),e=e.toLowerCase().trim().replace(/[\.`~!@#\$%\^&\*\(\)\{\}\[\]\\\|:;'",<>\/\?\-]/g,"").replace(/\s{2,}/g," ").trim(),n(`Normalized search term to ${e}`),!e?.length&&!i)return{results:[],unfilteredResultCount:0,filters:{},totalFilters:{},timings:{preload:Date.now()-r,search:Date.now()-r,total:Date.now()-r}};let o=this.stringifySorts(t.sort);n(`Stringified sort to ${o}`);const l=this.stringifyFilters(t.filters);n(`Stringified filters to ${l}`);let c=this.backend.request_indexes(a,e),h=this.backend.request_filter_indexes(a,l),d=c.split(" ").filter(e=>e).map(e=>this.loadChunk(e)),f=h.split(" ").filter(e=>e).map(e=>this.loadFilterChunk(e));if(await Promise.all([...d,...f]),n("Loaded necessary chunks to run search"),t.preload)return n("Preload \u2014 bailing out of search operation now."),null;a=await this.getPtr();let u=Date.now(),g=this.backend.search(a,e,l,o,s);n(`Got the raw search result: ${g}`);let[_,w,p,m]=g.split(/:([^:]*):(.*)__PF_UNFILTERED_DELIM__(.*)$/),y=this.parseFilters(p),b=this.parseFilters(m);n(`Remaining filters: ${JSON.stringify(g)}`);let k=w.length?w.split(" "):[],v=k.map(t=>{let[r,a,i]=t.split("@");n(`Processing result: \n  hash:${r}\n  score:${a}\n  locations:${i}`);let s=i.length?i.split(",").map(e=>{let[t,n,r]=e.split(">");return{weight:parseInt(t)/24,balanced_score:parseFloat(n),location:parseInt(r)}}):[],o=s.map(e=>e.location);return{id:r,score:parseFloat(a)*this.indexWeight,words:o,data:async()=>await this.loadFragment(r,s,e)}});const P=Date.now()-u,x=Date.now()-r;return n(`Found ${k.length} result${1==k.length?"":"s"} for "${e}" in ${Date.now()-u}ms (${Date.now()-r}ms realtime)`),{results:v,unfilteredResultCount:parseInt(_),filters:y,totalFilters:b,timings:{preload:x-P,search:P,total:x}}}},C=class{constructor(e={}){this.backend=r,this.primaryLanguage="unknown",this.searchID=0,this.primary=new R({...e,primary:!0}),this.instances=[this.primary],this.init(e?.language)}async options(e){await this.primary.options(e)}async init(e){if(document?.querySelector){const e=document.querySelector("html")?.getAttribute("lang")||"unknown";this.primaryLanguage=e.toLocaleLowerCase()}await this.primary.init(e||this.primaryLanguage,{load_wasm:!0})}async mergeIndex(e,t={}){if(this.primary.basePath.startsWith(e))return void console.warn(`Skipping mergeIndex ${e} that appears to be the same as the primary index (${this.primary.basePath})`);let n=new R({primary:!1,basePath:e});for(this.instances.push(n);null===this.primary.wasm;)await T(50);await n.init(t.language||this.primaryLanguage,{load_wasm:!1}),delete t.language,await n.options(t)}mergeFilters(e){const t={};for(const n of e)for(const[e,r]of Object.entries(n))if(t[e]){const n=t[e];for(const[e,t]of Object.entries(r))n[e]=(n[e]||0)+t}else t[e]=r;return t}async filters(){let e=await Promise.all(this.instances.map(e=>e.filters()));return this.mergeFilters(e)}async preload(e,t={}){await Promise.all(this.instances.map(n=>n.preload(e,t)))}async debouncedSearch(e,t,n){const r=++this.searchID;if(this.preload(e,t),await T(n),r!==this.searchID)return null;const a=await this.search(e,t);return r!==this.searchID?null:a}async search(e,t={}){let n=await Promise.all(this.instances.map(n=>n.search(e,t)));const r=this.mergeFilters(n.map(e=>e.filters)),a=this.mergeFilters(n.map(e=>e.totalFilters)),i=n.map(e=>e.results).flat().sort((e,t)=>t.score-e.score),s=n.map(e=>e.timings);return{results:i,unfilteredResultCount:n.reduce((e,t)=>e+t.unfilteredResultCount,0),filters:r,totalFilters:a,timings:s}}},j=void 0,q=void 0,N=()=>{j||(j=new C(q??{}))},O=async e=>{j?await j.options(e):q=e},B=async()=>{N()},J=async()=>{j=void 0,q=void 0},G=async(e,t)=>(N(),await j.mergeIndex(e,t)),z=async(e,t)=>(N(),await j.search(e,t)),Y=async(e,t,n=300)=>(N(),await j.debouncedSearch(e,t,n)),H=async(e,t)=>(N(),await j.preload(e,t)),V=async()=>(N(),await j.filters())}}]);